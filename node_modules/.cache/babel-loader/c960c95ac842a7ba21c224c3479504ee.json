{"ast":null,"code":"import _slicedToArray from\"/Users/mosmie/Documents/GitHub/cosmos/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{ReactComponent as Spinner}from\"@svgr/webpack?-svgo,+titleProp,+ref!../img/spinner.svg\";import ModalList from\"./ModalList\";import Row from\"../styled-components/Row\";import ModalUnderlay from\"../styled-components/ModalUnderlay\";import ModalWindow from\"../styled-components/ModalWindow\";import ModalContent from\"../styled-components/ModalContent\";import ModalGradient from\"../styled-components/ModalGradient\";import Tbody from\"../styled-components/Tbody\";import Thead from\"../styled-components/Thead\";import ModalTitle from\"../styled-components/ModalTitle\";import CloseIcon from\"../styled-components/Icons/IconClose\";import Centered from\"../styled-components/Centered\";import SortBtn from\"./SortBtn\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function checkStatus(response){if(response.status>=200&&response.status<300){return response;}else{throw Error(\"failed to execute request\");}}function Modal(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),spacePadData=_useState2[0],setSpacePadData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isSortedChaged=_useState4[0],setIsSortedChanged=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),sortFields=_useState6[0],setSortFields=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),areWeLoading=_useState8[0],setAreWeLoading=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];var componentMounted=true;// (3) component is mounted\nvar fetchData=function fetchData(){setError(null);console.log(\"GET feach\");console.log(spacePadData);var requestOptions={method:\"GET\"};fetch(\"https://api.spacexdata.com/v4/\".concat(props.tileToOpen),requestOptions).then(checkStatus).then(function(response){return response.json();}).then(function(data){// if (componentMounted){ // (5) is component still mounted?\nif(props.tileToOpen===\"crew\"){setSpacePadData(data);setSortFields([\"name\",\"agency\"]);}else if(props.tileToOpen===\"capsules\"){setSpacePadData(data);setSortFields([\"type\",\"status\"]);}else if(props.tileToOpen===\"starlink\"){setSpacePadData(data);setSortFields([\"version\",\"velocity_kms\"]);}else if(props.tileToOpen===\"rockets\"){setSpacePadData(data);setSortFields([\"name\",\"description\"]);}setAreWeLoading(false);//   }\n//   return () => { // This code runs when component is unmounted\n//     componentMounted = false; // (4) set it to false if we leave the page\n// }\n}).catch(function(err){setError(\"Error! Could not load data. Please try again.\");setAreWeLoading(false);});};useEffect(function(){console.log(\"use effect\");setAreWeLoading(true);fetchData();// const unsubscribe = fetchData(); //subscribe\n// return unsubscribe; //unsubscribe\n},[]);useEffect(function(){setIsSortedChanged(false);},[isSortedChaged]);var handleClose=function handleClose(){props.onClosed(false);setSpacePadData(null);console.log(spacePadData);};var dynamicSort=function dynamicSort(property,order){var sortOrder=1;if(order===\"desc\"){sortOrder=-1;}return function(a,b){if(a[property]<b[property]){return-1*sortOrder;}else if(a[property]>b[property]){return 1*sortOrder;}else{return 0*sortOrder;}};};var handlSort=function handlSort(sort){if(sort.descOrAsc===\"none\"){fetchData();}else{if(spacePadData!==null){var newSort=spacePadData.sort(dynamicSort(sort.name,sort.descOrAsc));setSpacePadData(newSort);}}setIsSortedChanged(true);};return/*#__PURE__*/_jsx(ModalUnderlay,{children:/*#__PURE__*/_jsx(ModalWindow,{children:/*#__PURE__*/_jsxs(ModalContent,{children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(ModalTitle,{children:[\" \",props.tileToOpen,\" \"]}),/*#__PURE__*/_jsx(CloseIcon,{onClick:handleClose})]}),error!==null&&/*#__PURE__*/_jsx(Centered,{children:/*#__PURE__*/_jsx(ModalTitle,{children:error})}),/*#__PURE__*/_jsx(Centered,{children:areWeLoading&&/*#__PURE__*/_jsx(Spinner,{})}),/*#__PURE__*/_jsxs(\"table\",{style:{borderSpacing:\"0px\"},children:[/*#__PURE__*/_jsx(Thead,{children:/*#__PURE__*/_jsx(\"tr\",{children:sortFields.map(function(item,key){return/*#__PURE__*/_jsx(\"th\",{style:{padding:\"0px\"},children:/*#__PURE__*/_jsx(SortBtn,{fild:item,onSortUpdate:handlSort})},key);})})}),/*#__PURE__*/_jsx(Tbody,{children:spacePadData&&spacePadData.map(function(item,key){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(ModalList,{pole:item,primeSortField:true,title:props.tileToOpen})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(ModalList,{pole:item,primeSortField:false,title:props.tileToOpen},key)})]},key);})})]}),/*#__PURE__*/_jsx(ModalGradient,{})]})})});}export default Modal;","map":{"version":3,"sources":["/Users/mosmie/Documents/GitHub/cosmos/src/components/Modal.tsx"],"names":["React","useEffect","useState","ModalList","Row","ModalUnderlay","ModalWindow","ModalContent","ModalGradient","Tbody","Thead","ModalTitle","CloseIcon","Centered","SortBtn","checkStatus","response","status","Error","Modal","props","spacePadData","setSpacePadData","isSortedChaged","setIsSortedChanged","sortFields","setSortFields","areWeLoading","setAreWeLoading","error","setError","componentMounted","fetchData","console","log","requestOptions","method","fetch","tileToOpen","then","json","data","catch","err","handleClose","onClosed","dynamicSort","property","order","sortOrder","a","b","handlSort","sort","descOrAsc","newSort","name","borderSpacing","map","item","key","padding"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { ICrewType, ICapsulesType, IStarlink, IRocketType } from \"./Types\";\nimport { SortCriteria } from \"./Sort\";\nimport { ReactComponent as Spinner } from \"../img/spinner.svg\";\nimport ModalList from \"./ModalList\";\n\nimport Row from \"../styled-components/Row\";\nimport ModalUnderlay from \"../styled-components/ModalUnderlay\";\nimport ModalWindow from \"../styled-components/ModalWindow\";\nimport ModalContent from \"../styled-components/ModalContent\";\nimport ModalGradient from \"../styled-components/ModalGradient\";\nimport Tbody from \"../styled-components/Tbody\";\nimport Thead from \"../styled-components/Thead\";\nimport ModalTitle from \"../styled-components/ModalTitle\";\nimport CloseIcon from \"../styled-components/Icons/IconClose\";\nimport Centered from \"../styled-components/Centered\";\nimport SortBtn from \"./SortBtn\";\n\nfunction checkStatus(response: Response): Response {\n  if (response.status >= 200 && response.status < 300) {\n    return response;\n  } else {\n    throw Error(\"failed to execute request\");\n  }\n}\n\ninterface ModalProps {\n  tileToOpen: any;\n  onClosed(a: any): any;\n}\n\nfunction Modal(props: ModalProps) {\n  const [spacePadData, setSpacePadData] = useState< null |\n    Array<ICrewType | ICapsulesType | IStarlink | IRocketType>\n  >([]);\n  const [isSortedChaged, setIsSortedChanged] = useState(false);\n  const [sortFields, setSortFields] = useState<string[]>([]);\n  const [areWeLoading, setAreWeLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  let componentMounted = true; // (3) component is mounted\n\n\n  const fetchData = () => {\n    setError(null);\n    console.log(\"GET feach\");\n    console.log(spacePadData);\n\n\n    let requestOptions = {\n      method: \"GET\",\n    };\n\n    fetch(`https://api.spacexdata.com/v4/${props.tileToOpen}`, requestOptions)\n      .then(checkStatus)\n      .then((response: Response) => response.json())\n      .then((data: any) => {\n        // if (componentMounted){ // (5) is component still mounted?\n\n        if (props.tileToOpen === \"crew\") {\n          setSpacePadData(data as ICrewType[]);\n          setSortFields([\"name\", \"agency\"]);\n        } else if (props.tileToOpen === \"capsules\") {\n          setSpacePadData(data as ICapsulesType[]);\n          setSortFields([\"type\", \"status\"]);\n        } else if (props.tileToOpen === \"starlink\") {\n          setSpacePadData(data as IStarlink[]);\n          setSortFields([\"version\", \"velocity_kms\"]);\n        } else if (props.tileToOpen === \"rockets\") {\n          setSpacePadData(data as IRocketType[]);\n          setSortFields([\"name\", \"description\"]);\n        }\n      \n        setAreWeLoading(false);\n    //   }\n    //   return () => { // This code runs when component is unmounted\n    //     componentMounted = false; // (4) set it to false if we leave the page\n    // }\n      })\n      .catch((err: Error) => {\n        setError(\"Error! Could not load data. Please try again.\");\n        setAreWeLoading(false);\n      });\n  };\n\n  useEffect(() => {\n    console.log(\"use effect\")\n    setAreWeLoading(true);\n    fetchData();\n    // const unsubscribe = fetchData(); //subscribe\n    // return unsubscribe; //unsubscribe\n  }, []);\n\n  useEffect(() => {\n    setIsSortedChanged(false);\n  }, [isSortedChaged]);\n\n  const handleClose = () => {\n    props.onClosed(false);\n    setSpacePadData(null)\n    console.log(spacePadData)\n  };\n\n  const dynamicSort = (property: any, order: any) => {\n    let sortOrder = 1;\n    if (order === \"desc\") {\n      sortOrder = -1;\n    }\n\n    return function (a: any, b: any) {\n      if (a[property] < b[property]) {\n        return -1 * sortOrder;\n      } else if (a[property] > b[property]) {\n        return 1 * sortOrder;\n      } else {\n        return 0 * sortOrder;\n      }\n    };\n  };\n\n  const handlSort = (sort: SortCriteria): void => {\n    if (sort.descOrAsc === \"none\") {\n      fetchData();\n    } else {\n      if (spacePadData !== null) {\n      let newSort = spacePadData.sort(dynamicSort(sort.name, sort.descOrAsc));\n      setSpacePadData(newSort);\n    }\n    }\n    setIsSortedChanged(true);\n  };\n\n  return (\n    <ModalUnderlay>\n      <ModalWindow>\n        <ModalContent>\n          <Row>\n            <ModalTitle> {props.tileToOpen} </ModalTitle>\n            <CloseIcon onClick={handleClose} />\n          </Row>\n\n          {error !== null && (\n            <Centered>\n              <ModalTitle>{error}</ModalTitle>\n            </Centered>\n          )}\n          <Centered>{areWeLoading && <Spinner />}</Centered>\n\n          <table style={{borderSpacing: \"0px\"}}>\n            <Thead>\n              <tr>\n                {sortFields.map((item, key) => (\n                  <th key={key} style={{padding: \"0px\"}}>\n                    <SortBtn fild={item} onSortUpdate={handlSort}></SortBtn>\n                  </th>\n                ))}\n              </tr>\n            </Thead>\n            <Tbody>\n              {spacePadData &&\n                spacePadData.map((item, key) => (\n                  <tr key={key}>\n                    <td>\n                      <ModalList\n                        pole={item}\n                        primeSortField={true}\n                        title={props.tileToOpen}\n                      />\n                    </td>\n                    <td>\n                      <ModalList\n                        key={key}\n                        pole={item}\n                        primeSortField={false}\n                        title={props.tileToOpen}\n                      />\n                    </td>\n                  </tr>\n                ))}\n            </Tbody>\n          </table>\n          <ModalGradient/>\n        </ModalContent>\n      </ModalWindow>\n    </ModalUnderlay>\n  );\n}\n\nexport default Modal;\n"]},"metadata":{},"sourceType":"module"}